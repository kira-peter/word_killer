## Context
Word Killer 目前只支持从单一词库文件加载单词。用户无法根据自己的水平调整单词难度。data 目录中已有三个按难度分类的单词文件 (short/medium/long),但目前未被充分利用。

此变更需要扩展配置系统和游戏核心逻辑,以支持多难度词库和比例控制。

## Goals / Non-Goals

### Goals
- 允许用户在配置文件中设定 short/medium/long 单词的随机比例
- 自动归一化用户输入的比例值,降低配置门槛
- 保持现有游戏逻辑的稳定性,不影响其他功能
- 确保跨词库单词不重复

### Non-Goals
- 不在运行时动态调整难度 (本次只支持配置文件方式)
- 不实现难度分析或推荐功能
- 不改变单词的显示方式或游戏规则

## Decisions

### 决策 1: 使用三个独立词库而非单一词库分类
**选择**: 在 Game 结构体中维护 `shortPool`, `mediumPool`, `longPool` 三个独立切片

**理由**:
- 数据文件已经按难度分好类,直接使用避免重复分类逻辑
- 内存占用可接受 (~10000 单词总计)
- 按比例采样时性能更好 (直接从对应池子随机)

**备选方案**:
- 方案 A: 单一 wordPool + 每个单词带难度标签 → 需要额外分类步骤,增加复杂度
- 方案 B: 动态加载词库 → 增加 I/O 开销,不必要

### 决策 2: 配置采用比例值而非固定数量
**选择**: 使用 `short_ratio: 30, medium_ratio: 50, long_ratio: 20` (百分比概念)

**理由**:
- 更直观,用户容易理解 "30% 短单词 + 50% 中等 + 20% 长单词"
- 与总单词数 (word_count) 解耦,配置更灵活
- 支持自动归一化 (1:2:1 等价于 25:50:25)

**备选方案**:
- 方案 A: 固定数量 (short_count: 6, medium_count: 10, long_count: 4) → 不灵活,总数改变时需要重新调整

### 决策 3: 自动归一化而非严格验证
**选择**: 允许用户输入任意正数比例,程序自动归一化为百分比

**理由**:
- 降低用户配置负担 (不需要精确计算为 100)
- 支持简单表示法 (1:1:1, 2:3:1 等)
- 错误配置概率低 (只要是正数即可)

**实现方式**:
```go
func NormalizeRatios(short, medium, long float64) (float64, float64, float64) {
    total := short + medium + long
    return short/total, medium/total, long/total
}
```

### 决策 4: 跨词库去重策略
**选择**: 使用全局 usedWords map 跟踪所有已选单词,无论来自哪个词库

**理由**:
- 确保游戏中无重复单词,保持体验一致性
- 实现简单,复用现有 usedWords 机制
- 性能影响可忽略 (map 查询是 O(1))

## Risks / Trade-offs

### 风险 1: 词库大小不均可能导致比例失真
**风险**: 如果用户配置 `long_ratio: 80%` 但 long 词库只有 2241 个单词,无法满足时如何处理?

**缓解措施**:
- 采用"尽力而为"策略:先从各词库按比例抽取,如果某词库不足,从其他词库补充
- 文档中说明各词库大小,建议用户合理配置比例
- 未来可考虑添加警告提示 (非本次实现)

### 风险 2: 配置复杂度增加
**风险**: 用户可能不理解比例配置的含义

**缓解措施**:
- 提供清晰的默认配置 (30:50:20)
- config.json 中添加注释示例
- 支持归一化,降低配置门槛

### Trade-off: 内存占用 vs 性能
- 三个词库会占用更多内存 (~10000 个字符串)
- 但换来的是更快的按比例采样速度
- 考虑到游戏规模,这个 trade-off 是值得的

## Migration Plan

### 向后兼容性
- 保留原有 `word_dict_path` 配置字段作为备用
- 如果用户未配置难度比例,默认使用 medium 词库 (保持原有行为)
- 新增配置项可选,不强制要求

### 升级步骤
1. 用户更新代码后,首次运行使用默认配置 (30:50:20)
2. 用户可根据需要修改 config.json 中的比例值
3. 无需数据迁移,词库文件已存在

### 回滚方案
- 如果出现问题,用户可删除难度比例配置,程序回退到单词库模式
- 代码保留向后兼容逻辑

## Open Questions
- 是否需要在游戏结束后显示本局单词的难度分布? (如 "Short: 6, Medium: 10, Long: 4")
- 未来是否考虑支持命令行参数覆盖配置文件? (如 `--difficulty-ratio=30:50:20`)
